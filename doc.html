<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>shellUnit &mdash; Quickstart</title>
<link rel="stylesheet" href="css/reset.css" />
<link rel="stylesheet" href="css/text.css" />
<link rel="stylesheet" href="css/shunit.css" />
</head>
<body>
<div id="header">
    <h1>
      shUnit.
    </h1>
	<p>
      shUnit is a unit-test framework for bash-style and csh-style shells. It provides a way to separate the tests from the scripts, test functions main procedure and code blocks from a shell script.
    </p>
</div>

<div id="content">
<table cellspacin=0 cellpadding=0>
<tr>
<td class="doc">
<p>A set os exaples will we shown now. This document is automatically generated by the mkdoc.sh script in the documents directory so commands and outputs match.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>A test script is a plain shell script with a few characteristics. Test functions are declared csh-style and start with 'test', also, to be recogniced by automatic directory testing, its extension must be '.shu'</p>
</td>
<td class="code">
<pre><code>#sample-01.shu
testSimpleTest () {
    #Add test here
    #Some shells (bash) don&#39;t like empty functions
    #so we add an echo here
    echo &quot;Test!&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>To execute a test file we use the 'shunit' command. It needs at least one parameter, indicating either a test file:</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shunit sample-01.shu</p>
</td>
<td class="code">
<pre><code>TEST: SimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>Or a directory containing various .shu files</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shunit ./sample-dir/</p>
</td>
<td class="code">
<pre><code>TEST: AnotherSimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------
TEST: SimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>To provide a target we use the 'shu_loadTarget' function which as a parameter has the path to the shell script to be tested. At pressent, loading a target executes its 'main' procedure (all commands not in a function) so be careful with that.</p>
</td>
<td class="code">
<pre><code>#sample-02.shu
shu_loadTarget ./target.sh

testASample () {
  OUTPUT=`aSample`
  assertEquals $OUTPUT &quot;SAMPLE&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The sample target file:</p>
</td>
<td class="code">
<pre><code>
aSample () {
  echo &quot;SAMPLE&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The output of shunit ./sample-02/</p>
</td>
<td class="code">
<pre><code>TEST: ASample
 Assert @5 succeeded. (4ms)
-----------------------------------
 All test completed in 4ms
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The test asserts that 'a_function' will echo the string 'TEST'. shunit provides many assertions for different situations. here is a test using all the 'basic' asserts.</p>
</td>
<td class="code">
<pre><code>#basic-asserts.shu

#This script will test the the basic asserts

testTrue () {
    assertTrue &quot;a = a&quot;
}

testFalse () {
    assertFalse &quot;a = b&quot;
}

testEquals () {
    assertEquals 2 2
    assertEquals &quot;a&quot; &quot;a&quot;
    assertEquals &quot;a&quot; a
    assertEquals &quot;2&quot; 2
}

testNotEquals () {
    assertNotEquals 1 2
    assertNotEquals &quot;A&quot; &quot;B&quot;
    assertNotEquals &quot;3&quot; 4
    assertNotEquals &quot;A&quot; Z
}

testGreaterThan () {
    assertGreaterThan 3 2
    assertGreaterThan &quot;5&quot; 1
}

testNotGreaterThan () {
    assertNotGreaterThan 3 5
    assertNotGreaterThan &quot;3&quot; 7
    assertNotGreaterThan 3 3
}

testLessThan () {
    assertLessThan 3 5
    assertLessThan &quot;3&quot; 5
}

testNotLessThan () {
    assertNotLessThan 5 4
    assertNotLessThan &quot;5&quot; 4
    assertNotLessThan 5 5
}

testMatches () {
    assertMatches &quot;[0-9]-[A-Z]&quot; &quot;1234-ASDF&quot;
}

testNotMatches () {
    assertNotMatches &quot;[0-9]-[A-Z]&quot; &quot;ASDF-1234&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The result of executing this test file is:</p>
</td>
<td class="code">
<pre><code>TEST: True
 Assert @5 succeeded. (6ms)
TEST: False
 Assert @9 failed. (5ms) Reason: expression is true
TEST: Equals
 Assert @13 succeeded. (3ms)
 Assert @14 succeeded. (5ms)
 Assert @15 succeeded. (6ms)
 Assert @16 succeeded. (4ms)
TEST: NotEquals
 Assert @20 succeeded. (3ms)
 Assert @21 succeeded. (5ms)
 Assert @22 succeeded. (5ms)
 Assert @23 succeeded. (5ms)
TEST: GreaterThan
 Assert @27 succeeded. (3ms)
 Assert @28 succeeded. (5ms)
TEST: NotGreaterThan
 Assert @32 succeeded. (2ms)
 Assert @33 succeeded. (5ms)
 Assert @34 succeeded. (5ms)
TEST: LessThan
 Assert @38 succeeded. (2ms)
 Assert @39 succeeded. (6ms)
TEST: NotLessThan
 Assert @43 succeeded. (2ms)
 Assert @44 succeeded. (8ms)
 Assert @45 succeeded. (5ms)
TEST: Matches
 Assert @49 succeeded. (3ms)
TEST: NotMatches
 Assert @53 succeeded. (3ms)
-----------------------------------
 All test completed in 177ms
 1 asserts failed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shunit works as a preprocessor for test files. This means that to provide meaningful messages and dispatch tests it reads a test file and its targets and produces a single shell script which is executed. Because of that, some variables won't be accesible from a shell script, most notably the return-value variable$?. To access the return value, the SHU_RV variable is provided.</p>
</td>
<td class="code">
<pre><code>#return-sample.shu

addition () {
  RV=`expr &quot;$1&quot; + &quot;$2&quot;`
  return $RV
}

testReturnValue () {
  addition 10 5
  assertEquals 15 $SHU_RV
  addition 100 0
  assertEquals 203 $SHU_RV
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>Executing the test will yield the following output. Notice that an assert, wether failed or not, will print the line it is located preceded by an '@', and if failed, a reason why will be provided. Also, any function not starting with 'test' will be ignored by shunit, this way we can make self-contained tests if wanted.</p>
</td>
<td class="code">
<pre><code>TEST: ReturnValue
 Assert @9 succeeded. (5ms)
 Assert @11 failed. (8ms) Reason: expected &#39;203&#39; but found &#39;100&#39;
-----------------------------------
 All test completed in 13ms
 1 asserts failed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>For testing the 'main' function, as if we called the script from the shell, shunit provided the 'shu_main' function, which will behave like the shell script.</p>
</td>
<td class="code">
<pre><code>testMain () {
    shu_main &quot;A parameter&quot; &quot;another param&quot;
    #Asserts below this line...
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shunit results can be formatted in different ways, the results shown so far being the default output formatter. So far, the default ot 'pretty' formatter and 'raw' are available. The 'raw' output can be activated by passing the --raw option to shunit. This format is intended to be used by other programs as its input. It provides various information about the tests and asserts being run in CSV format.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>An example of the raw output, using the basic asserts files:</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shunit --raw basic-asserts.shu</p>
</td>
<td class="code">
<pre><code>SHU,TEST,1394104721453,basic-asserts.shu,True
SHU,ASSERT,basic-asserts.shu,True,5,1394104721453,1394104721459,OK,
SHU,TEST,1394104721470,basic-asserts.shu,False
SHU,ASSERT,basic-asserts.shu,False,9,1394104721470,1394104721475,FAIL,expression is true
SHU,TEST,1394104721485,basic-asserts.shu,Equals
SHU,ASSERT,basic-asserts.shu,Equals,13,1394104721485,1394104721488,OK,
SHU,ASSERT,basic-asserts.shu,Equals,14,1394104721488,1394104721494,OK,
SHU,ASSERT,basic-asserts.shu,Equals,15,1394104721494,1394104721498,OK,
SHU,ASSERT,basic-asserts.shu,Equals,16,1394104721498,1394104721504,OK,
SHU,TEST,1394104721511,basic-asserts.shu,NotEquals
SHU,ASSERT,basic-asserts.shu,NotEquals,20,1394104721511,1394104721516,OK,
SHU,ASSERT,basic-asserts.shu,NotEquals,21,1394104721516,1394104721523,OK,
SHU,ASSERT,basic-asserts.shu,NotEquals,22,1394104721523,1394104721531,OK,
SHU,ASSERT,basic-asserts.shu,NotEquals,23,1394104721531,1394104721537,OK,
SHU,TEST,1394104721547,basic-asserts.shu,GreaterThan
SHU,ASSERT,basic-asserts.shu,GreaterThan,27,1394104721547,1394104721550,OK,
SHU,ASSERT,basic-asserts.shu,GreaterThan,28,1394104721550,1394104721556,OK,
SHU,TEST,1394104721566,basic-asserts.shu,NotGreaterThan
SHU,ASSERT,basic-asserts.shu,NotGreaterThan,32,1394104721566,1394104721568,OK,
SHU,ASSERT,basic-asserts.shu,NotGreaterThan,33,1394104721568,1394104721574,OK,
SHU,ASSERT,basic-asserts.shu,NotGreaterThan,34,1394104721574,1394104721579,OK,
SHU,TEST,1394104721587,basic-asserts.shu,LessThan
SHU,ASSERT,basic-asserts.shu,LessThan,38,1394104721587,1394104721591,OK,
SHU,ASSERT,basic-asserts.shu,LessThan,39,1394104721591,1394104721596,OK,
SHU,TEST,1394104721604,basic-asserts.shu,NotLessThan
SHU,ASSERT,basic-asserts.shu,NotLessThan,43,1394104721604,1394104721606,OK,
SHU,ASSERT,basic-asserts.shu,NotLessThan,44,1394104721606,1394104721612,OK,
SHU,ASSERT,basic-asserts.shu,NotLessThan,45,1394104721612,1394104721617,OK,
SHU,TEST,1394104721627,basic-asserts.shu,Matches
SHU,ASSERT,basic-asserts.shu,Matches,49,1394104721627,1394104721630,OK,
SHU,TEST,1394104721641,basic-asserts.shu,NotMatches
SHU,ASSERT,basic-asserts.shu,NotMatches,53,1394104721641,1394104721643,OK,</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The CSV format is not yet frozen so no information on what each column is will be provided until then.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>Test scripts may optionally have a 'setup' and 'teardown' function, which will be executed before and after every test respectively.</p>
</td>
<td class="code">
<pre><code>#sample_test.shu

setup () {
    #Test setup goes here:
}

teardown () {
    #Test teardown goes here
}

testOne () {
    #A test
}

testTwo () {
    #Another test
}</code></pre>
</td>
</tr>
</table>
</div>
<div id="footer">
  <p>Footer</p>
</div>
</body>
