<!DOCTYPE html>
<html lang="en">
<!-- Generated by mkdoc.sh -->
<head>
<meta charset="utf-8" />
<title>shellUnit &mdash; Quickstart</title>
<link rel="stylesheet" href="css/reset.css" />
<link rel="stylesheet" href="css/shunit.css" />
</head>
<body>
<div id="header">
    <h1>
      <img src="./img/shellUnit.png" alt="shellUnit">
    </h1>
</div>

<div id="content">
<table>
<tr id="Introduction">
  <th class="doc">
Introduction
  </th>
  <td class="code"></td>
</tr>
<tr>
<td class="doc">
<p>shellUnit is a unit-test framework for bash-style and csh-style shells. It provides a way to separate the tests from the scripts, test functions main procedure and code blocks from a shell script.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>A set os exaples will we shown now. This document is automatically generated by the mkdoc.sh script in the documents directory so commands and outputs match.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr id="Sample">
  <th class="doc">
Sample
  </th>
  <td class="code"></td>
</tr>
<tr>
<td class="doc">
<p>A test script is a plain shell script with a few characteristics. Test functions are declared csh-style and start with 'test', also, to be recogniced by automatic directory testing, its extension must be '.shu'</p>
</td>
<td class="code">
<pre><code>#sample-01.shu
testSimpleTest () {
    #Add test here
    #Some shells (bash) don&#39;t like empty functions
    #so we add an echo here
    echo &quot;Test!&quot;
}</code></pre>
</td>
</tr>
<tr id="Running">
  <th class="doc">
Running
  </th>
  <td class="code"></td>
</tr>
<tr>
<td class="doc">
<p>To execute a test file we use the 'shu' command. It needs at least one parameter, indicating either a test file:</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shu sample-01.shu</p>
</td>
<td class="code">
<pre><code>TEST: SimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>Or a directory containing various .shu files</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shu ./sample-dir/</p>
</td>
<td class="code">
<pre><code>TEST: AnotherSimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------
TEST: SimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr id="Targetting">
  <th class="doc">
Targetting
  </th>
  <td class="code"></td>
</tr>
<tr>
<td class="doc">
<p>To provide a target we use the 'shu_loadTarget' function which as a parameter has the path to the shell script to be tested. At pressent, loading a target executes its 'main' procedure (all commands not in a function) so be careful with that.</p>
</td>
<td class="code">
<pre><code>#sample-02.shu
shu_loadTarget ./target.sh

testASample () {
  OUTPUT=`aSample`
  assertEquals $OUTPUT &quot;SAMPLE&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The sample target file:</p>
</td>
<td class="code">
<pre><code>
aSample () {
  echo &quot;SAMPLE&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The output of shu ./sample-02/</p>
</td>
<td class="code">
<pre><code>TEST: ASample
 Assert @5 succeeded. (4ms)
-----------------------------------
 All test completed in 4ms
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The test asserts that 'a_function' will echo the string 'TEST'. shellUnit provides many assertions for different situations. here is a test using all the 'basic' asserts.</p>
</td>
<td class="code">
<pre><code>#basic-asserts.shu

#This script will test the the basic asserts

testTrue () {
    assertTrue &quot;[ a = a ]&quot;
}

testFalse () {
    assertFalse &quot;[ a = b ]&quot;
}

testEquals () {
    assertEquals 2 2
    assertEquals &quot;a&quot; &quot;a&quot;
    assertEquals &quot;a&quot; a
    assertEquals &quot;2&quot; 2
}

testNotEquals () {
    assertNotEquals 1 2
    assertNotEquals &quot;A&quot; &quot;B&quot;
    assertNotEquals &quot;3&quot; 4
    assertNotEquals &quot;A&quot; Z
}

testGreaterThan () {
    assertGreaterThan 3 2
    assertGreaterThan &quot;5&quot; 1
}

testNotGreaterThan () {
    assertNotGreaterThan 3 5
    assertNotGreaterThan &quot;3&quot; 7
    assertNotGreaterThan 3 3
}

testLessThan () {
    assertLessThan 3 5
    assertLessThan &quot;3&quot; 5
}

testNotLessThan () {
    assertNotLessThan 5 4
    assertNotLessThan &quot;5&quot; 4
    assertNotLessThan 5 5
}

testMatches () {
    assertMatches &quot;[0-9]-[A-Z]&quot; &quot;1234-ASDF&quot;
}

testNotMatches () {
    assertNotMatches &quot;[0-9]-[A-Z]&quot; &quot;ASDF-1234&quot;
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The result of executing this test file is:</p>
</td>
<td class="code">
<pre><code>TEST: True
 Assert @5 succeeded. (3ms)
TEST: False
 Assert @9 succeeded. (3ms)
TEST: Equals
 Assert @13 succeeded. (3ms)
 Assert @14 succeeded. (5ms)
 Assert @15 succeeded. (6ms)
 Assert @16 succeeded. (6ms)
TEST: NotEquals
 Assert @20 succeeded. (3ms)
 Assert @21 succeeded. (5ms)
 Assert @22 succeeded. (6ms)
 Assert @23 succeeded. (5ms)
TEST: GreaterThan
 Assert @27 succeeded. (3ms)
 Assert @28 succeeded. (5ms)
TEST: NotGreaterThan
 Assert @32 succeeded. (4ms)
 Assert @33 succeeded. (5ms)
 Assert @34 succeeded. (7ms)
TEST: LessThan
 Assert @38 succeeded. (3ms)
 Assert @39 succeeded. (6ms)
TEST: NotLessThan
 Assert @43 succeeded. (3ms)
 Assert @44 succeeded. (4ms)
 Assert @45 succeeded. (5ms)
TEST: Matches
 Assert @49 succeeded. (3ms)
TEST: NotMatches
 Assert @53 succeeded. (4ms)
-----------------------------------
 All test completed in 174ms
 All assert(s) passed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shellUnit works as a preprocessor for test files. This means that to provide meaningful messages and dispatch tests it reads a test file and its targets and produces a single shell script which is executed. Because of that, some variables won't be accesible from a shell script, most notably the return-value variable$?. To access the return value, the SHU_RV variable is provided.</p>
</td>
<td class="code">
<pre><code>#return-sample.shu

addition () {
  RV=`expr &quot;$1&quot; + &quot;$2&quot;`
  return $RV
}

testReturnValue () {
  addition 10 5
  assertEquals 15 $SHU_RV
  addition 100 0
  assertEquals 203 $SHU_RV
}</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>Executing the test will yield the following output. Notice that an assert, wether failed or not, will print the line it is located preceded by an '@', and if failed, a reason why will be provided. Also, any function not starting with 'test' will be ignored by shellUnit, this way we can make self-contained tests if wanted.</p>
</td>
<td class="code">
<pre><code>TEST: ReturnValue
 Assert @9 succeeded. (6ms)
 Assert @11 failed. (7ms) Reason: expected &#39;203&#39; but found &#39;100&#39;
-----------------------------------
 All test completed in 13ms
 1 asserts failed.
-----------------------------------</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>For testing the 'main' function, as if we called the script from the shell, shellUnit provided the 'shu_main' function, which will behave like the shell script.</p>
</td>
<td class="code">
<pre><code>testMain () {
    shu_main &quot;A parameter&quot; &quot;another param&quot;
    #Asserts below this line...
}</code></pre>
</td>
</tr>
<tr id="Results">
  <th class="doc">
Results
  </th>
  <td class="code"></td>
</tr>
<tr>
<td class="doc">
<p>shellUnit results can be formatted in different ways, the results shown so far being the default output formatter. So far, all samples were using the default 'pretty' formatter.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The 'raw' output formatter present the test result as CSV. Raw output can be activated by passing the --raw option to shellUnit. This format is intended to be used by other programs as its input. It provides various information about the tests and asserts being run.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>An example of the raw output, using the basic asserts files:</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>shu --raw basic-asserts.shu</p>
</td>
<td class="code">
<pre><code>SHU,TEST,1394704477760,basic-asserts.shu,True
SHU,ASSERT,basic-asserts.shu,True,5,1394704477760,1394704477763,OK,
SHU,TEST,1394704477772,basic-asserts.shu,False
SHU,ASSERT,basic-asserts.shu,False,9,1394704477772,1394704477775,OK,
SHU,TEST,1394704477784,basic-asserts.shu,Equals
SHU,ASSERT,basic-asserts.shu,Equals,13,1394704477784,1394704477786,OK,
SHU,ASSERT,basic-asserts.shu,Equals,14,1394704477786,1394704477792,OK,
SHU,ASSERT,basic-asserts.shu,Equals,15,1394704477792,1394704477797,OK,
SHU,ASSERT,basic-asserts.shu,Equals,16,1394704477797,1394704477803,OK,
SHU,TEST,1394704477811,basic-asserts.shu,NotEquals
SHU,ASSERT,basic-asserts.shu,NotEquals,20,1394704477811,1394704477814,OK,
SHU,ASSERT,basic-asserts.shu,NotEquals,21,1394704477814,1394704477819,OK,
SHU,ASSERT,basic-asserts.shu,NotEquals,22,1394704477819,1394704477825,OK,
SHU,ASSERT,basic-asserts.shu,NotEquals,23,1394704477825,1394704477830,OK,
SHU,TEST,1394704477837,basic-asserts.shu,GreaterThan
SHU,ASSERT,basic-asserts.shu,GreaterThan,27,1394704477837,1394704477841,OK,
SHU,ASSERT,basic-asserts.shu,GreaterThan,28,1394704477841,1394704477845,OK,
SHU,TEST,1394704477855,basic-asserts.shu,NotGreaterThan
SHU,ASSERT,basic-asserts.shu,NotGreaterThan,32,1394704477855,1394704477857,OK,
SHU,ASSERT,basic-asserts.shu,NotGreaterThan,33,1394704477857,1394704477863,OK,
SHU,ASSERT,basic-asserts.shu,NotGreaterThan,34,1394704477863,1394704477868,OK,
SHU,TEST,1394704477877,basic-asserts.shu,LessThan
SHU,ASSERT,basic-asserts.shu,LessThan,38,1394704477877,1394704477879,OK,
SHU,ASSERT,basic-asserts.shu,LessThan,39,1394704477879,1394704477884,OK,
SHU,TEST,1394704477892,basic-asserts.shu,NotLessThan
SHU,ASSERT,basic-asserts.shu,NotLessThan,43,1394704477892,1394704477895,OK,
SHU,ASSERT,basic-asserts.shu,NotLessThan,44,1394704477895,1394704477901,OK,
SHU,ASSERT,basic-asserts.shu,NotLessThan,45,1394704477901,1394704477907,OK,
SHU,TEST,1394704477915,basic-asserts.shu,Matches
SHU,ASSERT,basic-asserts.shu,Matches,49,1394704477915,1394704477918,OK,
SHU,TEST,1394704477925,basic-asserts.shu,NotMatches
SHU,ASSERT,basic-asserts.shu,NotMatches,53,1394704477925,1394704477929,OK,</code></pre>
</td>
</tr>
<tr>
<td class="doc">
<p>The CSV format is not yet frozen so no information on what each column is will be provided until then.</p>
</td>
<td class="code">
<pre><code></code></pre>
</td>
</tr>
<tr id="Setup/Teardown">
  <th class="doc">
Setup/Teardown
  </th>
  <td class="code"></td>
</tr>
<tr>
<td class="doc">
<p>Test scripts may optionally have a 'setup' and 'teardown' function, which will be executed before and after every test respectively.</p>
</td>
<td class="code">
<pre><code>#sample_test.shu

setup () {
    #Test setup goes here:
}

teardown () {
    #Test teardown goes here
}

testOne () {
    #A test
}

testTwo () {
    #Another test
}</code></pre>
</td>
</tr>
<tr id="Groups">
  <th class="doc">
Groups
  </th>
  <td class="code"></td>
</tr>
<tr id="Parametrized_test">
  <th class="doc">
Parametrized test
  </th>
  <td class="code"></td>
</tr>
</table>
</div>
<div id="footer">
  <p>
   © 2014 shellUnit, see <a href="COPYING.txt">copying</a> for copyright information.
  </p>
  <a class="right" href="humans.txt" target="_blank"><img src="img/humanstxt-transparent-color.png" alt="humans.txt"></a>
</div>

<div id="menu">
<ul>

      <li><h3><a href="#Introduction">Introduction</a></h3></li>
      <li><h3><a href="#Sample">Sample</a></h3></li>
      <li><h3><a href="#Running">Running</a></h3></li>
      <li><h3><a href="#Targetting">Targetting</a></h3></li>
      <li><h3><a href="#Results">Results</a></h3></li>
      <li><h3><a href="#Setup/Teardown">Setup/Teardown</a></h3></li>
      <li><h3><a href="#Groups">Groups</a></h3></li>
      <li><h3><a href="#Parametrized_test">Parametrized test</a></h3></li>
</ul>
</div>
</body></html>
