<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>960 Grid System &mdash; Demo</title>
<link rel="stylesheet" href="css/reset.css" />
<link rel="stylesheet" href="css/text.css" />
<link rel="stylesheet" href="css/960_24_col.css" />
<!-- <link rel="stylesheet" href="css/demo.css" /> -->
</head>
<body>
<div class="container_24">
  <!-- Header -->
  <div class="grid_24">
    <p>
      shUnit.
    </p>
	<p>
      shUnit is a unit-test framework for bash-style and csh-style shells. It provides a way to separate the tests from the scripts, test functions main procedure and code blocks from a shell script.
    </p>
  </div>
<div class="grid_11">
<p>A set os exaples will we shown now. This document is automatically generated by the mkdoc.sh script in the documents directory so commands and outputs match.</p>
</div>
<div class="grid_13">

</div>
<div class="clear"></div>
<div class="grid_11">
<p>A test script is a plain shell script with a few characteristics. Test functions are declared csh-style and start with 'test', also, to be recogniced by automatic directory testing, its extension must be '.shu'</p>
</div>
<div class="grid_13">
<pre><code>#sample-01.shu
testSimpleTest () {
    #Add test here
    #Some shells (bash) don&#39;t like empty functions
    #so we add an echo here
    echo &quot;Test!&quot;
}</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>To execute a test file we use the 'shunit' command. It needs at least one parameter, indicating either a test file:</p>
</div>
<div class="grid_13">

</div>
<div class="clear"></div>
<div class="grid_11">
<p>shunit sample-01.shu</p>
</div>
<div class="grid_13">
<pre><code>TEST: SimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>Or a directory containing various .shu files</p>
</div>
<div class="grid_13">

</div>
<div class="clear"></div>
<div class="grid_11">
<p>shunit ./sample-dir/</p>
</div>
<div class="grid_13">
<pre><code>TEST: AnotherSimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------
TEST: SimpleTest
-----------------------------------
 All test completed in 1ms
 Warning: No asserts run!
 All assert(s) passed.
-----------------------------------</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>To provide a target we use the 'shu_loadTarget' function which as a parameter has the path to the shell script to be tested. At pressent, loading a target executes its 'main' procedure (all commands not in a function) so be careful with that.</p>
</div>
<div class="grid_13">
<pre><code>#sample-02.shu
shu_loadTarget ./target.sh

testAFunction () {
  OUTPUT=`a_function`
  assertEquals $OUTPUT &quot;SAMPLE&quot;
}</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>The sample target file:</p>
</div>
<div class="grid_13">
<pre><code>a_function () {
  echo &quot;SAMPLE&quot;
}</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>The output of shunit ./sample-02/</p>
</div>
<div class="grid_13">
<pre><code>TEST: AFunction
 Assert @4 succeeded. (3ms)
-----------------------------------
 All test completed in 3ms
 All assert(s) passed.
-----------------------------------</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>The test asserts that 'a_function' will echo the string 'TEST'. shunit provides many assertions for different situations. here is a test using all the 'basic' asserts.</p>
</div>
<div class="grid_13">
<pre><code>#basic-asserts.shu

#This script will test the the basic asserts

testTrue () {
    assertTrue &quot;a = a&quot;
}

testFalse () {
    assertFalse &quot;a = b&quot;
}

testEquals () {
    assertEquals 2 2
    assertEquals &quot;a&quot; &quot;a&quot;
    assertEquals &quot;a&quot; a
    assertEquals &quot;2&quot; 2
}

testNotEquals () {
    assertNotEquals 1 2
    assertNotEquals &quot;A&quot; &quot;B&quot;
    assertNotEquals &quot;3&quot; 4
    assertNotEquals &quot;A&quot; Z
}

testGreaterThan () {
    assertGreaterThan 3 2
    assertGreaterThan &quot;5&quot; 1
}

testNotGreaterThan () {
    assertNotGreaterThan 3 5
    assertNotGreaterThan &quot;3&quot; 7
    assertNotGreaterThan 3 3
}

testLessThan () {
    assertLessThan 3 5
    assertLessThan &quot;3&quot; 5
}

testNotLessThan () {
    assertNotLessThan 5 4
    assertNotLessThan &quot;5&quot; 4
    assertNotLessThan 5 5
}

testMatches () {
    assertMatches &quot;[0-9]-[A-Z]&quot; &quot;1234-ASDF&quot;
}

testNotMatches () {
    assertNotMatches &quot;[0-9]-[A-Z]&quot; &quot;ASDF-1234&quot;
}</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>The result of executing this test file is:</p>
</div>
<div class="grid_13">
<pre><code>TEST: True
 Assert @5 succeeded. (2ms)
TEST: False
 Assert @9 failed. (2ms) Reason: expression is true
TEST: Equals
 Assert @13 succeeded. (2ms)
 Assert @14 succeeded. (6ms)
 Assert @15 succeeded. (9ms)
 Assert @16 succeeded. (13ms)
TEST: NotEquals
 Assert @20 succeeded. (2ms)
 Assert @21 succeeded. (6ms)
 Assert @22 succeeded. (10ms)
 Assert @23 succeeded. (14ms)
TEST: GreaterThan
 Assert @27 succeeded. (2ms)
 Assert @28 succeeded. (6ms)
TEST: NotGreaterThan
 Assert @32 succeeded. (2ms)
 Assert @33 succeeded. (5ms)
 Assert @34 succeeded. (9ms)
TEST: LessThan
 Assert @38 succeeded. (2ms)
 Assert @39 succeeded. (5ms)
TEST: NotLessThan
 Assert @43 succeeded. (1ms)
 Assert @44 succeeded. (5ms)
 Assert @45 succeeded. (9ms)
TEST: Matches
 Assert @49 succeeded. (2ms)
TEST: NotMatches
 Assert @53 succeeded. (2ms)
-----------------------------------
 All test completed in 117ms
 1 asserts failed.
-----------------------------------</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>shunit works as a preprocessor for test files. This means that to provide meaningful messages and dispatch tests it reads a test file and its targets and produces a single shell script which is executed. Because of that, some variables won't be accesible from a shell script, most notably the return-value variable$?. To access the return value, the SHU_RV variable is provided.</p>
</div>
<div class="grid_13">
<pre><code>#return-sample.shu

addition () {
  RV=`expr &quot;$1&quot; + &quot;$2&quot;`
  return $RV
}

testReturnValue () {
  addition 10 5
  assertEquals 15 $SHU_RV
  addition 100 0
  assertEquals 203 $SHU_RV
}</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>Executing the test will yield the following output. Notice that an assert, wether failed or not, will print the line it is located preceded by an '@', and if failed, a reason why will be provided. Also, any function not starting with 'test' will be ignored by shunit, this way we can make self-contained tests if wanted.</p>
</div>
<div class="grid_13">
<pre><code>TEST: ReturnValue
 Assert @9 succeeded. (4ms)
 Assert @11 failed. (9ms) Reason: expected &#39;203&#39; but found &#39;100&#39;
-----------------------------------
 All test completed in 9ms
 1 asserts failed.
-----------------------------------</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>For testing the 'main' function, as if we called the script from the shell, shunit provided the 'shu_main' function, which will behave like the shell script.</p>
</div>
<div class="grid_13">
<pre><code>testMain () {
    shu_main &quot;A parameter&quot; &quot;another param&quot;
    #Asserts below this line...
}</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>shunit results can be formatted in different ways, the results shown so far being the default output formatter. So far, the default ot 'pretty' formatter and 'raw' are available. The 'raw' output can be activated by passing the --raw option to shunit. This format is intended to be used by other programs as its input. It provides various information about the tests and asserts being run in CSV format.</p>
</div>
<div class="grid_13">

</div>
<div class="clear"></div>
<div class="grid_11">
<p>An example of the raw output, using the basic asserts files:</p>
</div>
<div class="grid_13">

</div>
<div class="clear"></div>
<div class="grid_11">
<p>shunit --raw basic-asserts.shu</p>
</div>
<div class="grid_13">
<pre><code>SHU,TEST,True
SHU,ASSERT,/bin/bash,True,5,1391477758023,1391477758026,OK,
SHU,TEST,False
SHU,ASSERT,/bin/bash,False,9,1391477758031,1391477758033,FAIL,expression is true
SHU,TEST,Equals
SHU,ASSERT,/bin/bash,Equals,13,1391477758040,1391477758042,OK,
SHU,ASSERT,/bin/bash,Equals,14,1391477758040,1391477758046,OK,
SHU,ASSERT,/bin/bash,Equals,15,1391477758040,1391477758049,OK,
SHU,ASSERT,/bin/bash,Equals,16,1391477758040,1391477758053,OK,
SHU,TEST,NotEquals
SHU,ASSERT,/bin/bash,NotEquals,20,1391477758059,1391477758061,OK,
SHU,ASSERT,/bin/bash,NotEquals,21,1391477758059,1391477758064,OK,
SHU,ASSERT,/bin/bash,NotEquals,22,1391477758059,1391477758068,OK,
SHU,ASSERT,/bin/bash,NotEquals,23,1391477758059,1391477758072,OK,
SHU,TEST,GreaterThan
SHU,ASSERT,/bin/bash,GreaterThan,27,1391477758078,1391477758080,OK,
SHU,ASSERT,/bin/bash,GreaterThan,28,1391477758078,1391477758083,OK,
SHU,TEST,NotGreaterThan
SHU,ASSERT,/bin/bash,NotGreaterThan,32,1391477758089,1391477758091,OK,
SHU,ASSERT,/bin/bash,NotGreaterThan,33,1391477758089,1391477758095,OK,
SHU,ASSERT,/bin/bash,NotGreaterThan,34,1391477758089,1391477758098,OK,
SHU,TEST,LessThan
SHU,ASSERT,/bin/bash,LessThan,38,1391477758103,1391477758105,OK,
SHU,ASSERT,/bin/bash,LessThan,39,1391477758103,1391477758109,OK,
SHU,TEST,NotLessThan
SHU,ASSERT,/bin/bash,NotLessThan,43,1391477758115,1391477758117,OK,
SHU,ASSERT,/bin/bash,NotLessThan,44,1391477758115,1391477758120,OK,
SHU,ASSERT,/bin/bash,NotLessThan,45,1391477758115,1391477758124,OK,
SHU,TEST,Matches
SHU,ASSERT,/bin/bash,Matches,49,1391477758130,1391477758132,OK,
SHU,TEST,NotMatches
SHU,ASSERT,/bin/bash,NotMatches,53,1391477758138,1391477758140,OK,</code></pre>
</div>
<div class="clear"></div>
<div class="grid_11">
<p>The CSV format is not yet frozen so no information on what each column is will be provided until then.</p>
</div>
<div class="grid_13">

</div>
<div class="clear"></div>
<div class="grid_11">
<p>Test scripts may optionally have a 'setup' and 'teardown' function, which will be executed before and after every test respectively.</p>
</div>
<div class="grid_13">
<pre><code>#sample_test.shu

setup () {
    #Test setup goes here:
}

teardown () {
    #Test teardown goes here
}

testOne () {
    #A test
}

testTwo () {
    #Another test
}</code></pre>
</div>
<div class="clear"></div>
</div>
</body>
